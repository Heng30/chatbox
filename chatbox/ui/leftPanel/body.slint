import { Theme } from "../theme.slint";
import { Store } from "../store.slint";
import { Logic } from "../logic.slint";
import { IconBtn } from "../base/icon-btn.slint";

export component Body inherits Rectangle {
    private property<length> item-height: 45px;

    Flickable {
        viewport-height: Store.chat-sessions.length * root.item-height;

        for data[index] in Store.chat-sessions : Rectangle {
            y: index * item-height;
            height: root.item-height;
            background: data.uuid == Store.current-session-uuid ? Theme.brand-color.darker(70%) : (touch.pressed ? Theme.brand-color.darker(50%) : touch.has-hover ? Theme.brand-color.darker(30%) : Colors.transparent);

            touch := TouchArea {
                clicked => {
                    Logic.switch-session(Store.current-session-uuid, data.uuid);
                }
            }

            HorizontalLayout {
                padding: Theme.padding;

                VerticalLayout {
                    alignment: center;
                    padding-left: Theme.padding;
                    Text {
                    color: data.uuid == Store.current-session-uuid ? Theme.basic-white-color : Theme.basic-black-color;
                        text: data.name;
                        font-size: Theme.enlarge-font-size;
                    }
                }

                HorizontalLayout {
                    alignment: end;
                    padding-right: Theme.padding;
                    spacing: Theme.spacing * 2;

                    VerticalLayout {
                        alignment: center;
                        IconBtn {
                            icon: @image-url("../images/star.svg");
                            colorize: data.is-mark ? Theme.mark-color : Theme.unmark-color;
                            clicked => {
                                Logic.toggle-mark-session(data.uuid);
                            }
                        }
                    }
                }
            }
        }
    }
}

